<!DOCTYPE html>
<html>








<head>
    <title>Candella Documentation - Accounts Service</title>
    <link href="../css/vanilla.min.css" rel="stylesheet" />
    <link href="../css/style.css" rel="stylesheet" />
    <link href="../css/version-select.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Candella Documentation - Accounts Service" />
    <meta property="og:description" content="Candella is a fork of the AliceOS framework for Ren'Py." />
    <meta property="og:url" content="None" />
    <meta property="og:image" content="http://candella.unscriptedvn.dev/img/desktop.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1280" />
    <meta property="og:image:height" content="720" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/json.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../search/main.js" defer=""></script>
    <script src="../js/vanilla.js" defer=""></script>
    <script src="../js/version-select.js" defer=""></script>
</head>

<div class="cc-header">
    <div class="row">
        <p>
            <a class="p-link--inverted" href="https://candella.unscriptedvn.dev">Candella</a>
            <sup>beta</sup>
        </p>
    </div>
</div>
<nav>
    <header id="navigation" class="p-navigation is-dark">
        <div class="p-navigation__row">
            <div class="p-navigation__banner">
                <div class="p-navigation__logo">
                    <a class="p-navigation__item" href="/index.html">
                        <img class="p-navigation__image" src="../img/logomark-dark.svg"
                            alt="Candella Documentation" width="95">
                    </a>
                </div>
                <a href="#navigation" class="p-navigation__toggle--open" title="menu">Menu</a>
                <a href="#navigation-closed" class="p-navigation__toggle--close" title="close menu">Close menu</a>
            </div>
            <nav class="p-navigation__nav" aria-label="Example main navigation">
                <span class="u-off-screen">
                    <a href="#main-content">Jump to main content</a>
                </span>
                <ul class="p-navigation__items">
                    <li class="p-navigation__item is-selected">
                        <a class="p-navigation__link" href="/index.html">Docs</a>
                    </li>
                    
                    
                    <li class="p-navigation__item">
                        <a class="p-navigation__link" href="https://marquiskurt.itch.io/candella">Download</a>
                    </li>
                    
                    <li class="p-navigation__item">
                        <a class="p-navigation__link" href="https://github.com/UnscriptedVN/candella">GitHub</a>
                    </li>
                    
                    <li class="p-navigation__item">
                        <a class="p-navigation__link" href="https://appdb.unscriptedvn.dev">AppDB</a>
                    </li>
                    
                    
                </ul>
                
                <form class="p-search-box" action="../search.html" method="get">
                    <input class="p-search-box__input" type="text" placeholder="Search docs" name="q" autocomplete="off"
                        id="mkdocs-search-query" required="">
                    <button type="reset" class="p-search-box__reset"><i class="p-icon--close"></i></button>
                    <button type="submit" class="p-search-box__button"><i class="p-icon--search"></i></button>
                </form>
                
            </nav>
        </div>
    </header>
</nav>

<body>
    
    <div class="p-strip--suru-topped">
        <div class="row">
            

<div class="p-side-navigation col-3" id="drawer">
    <a href="#drawer" class="p-side-navigation__toggle js-drawer-toggle" aria-controls="drawer">
        Toggle side navigation
    </a>
    <div class="p-side-navigation__overlay js-drawer-toggle" aria-controls="drawer"></div>

    <nav class="p-side-navigation__drawer" aria-label="Example side navigation">
        <div class="p-side-navigation__drawer-header">
            <a href="#" class="p-side-navigation__toggle--in-drawer js-drawer-toggle" aria-controls="drawer">
                Toggle side navigation
            </a>
        </div>

        <div id="version-selector"></div>

        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href=".." >Home</a>
            </li>
            
            
            
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../00-release-notes/" >Release Notes</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../00-release-notes/#v2107-apple-cinnamon">v21.07 (Apple Cinnamon)</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../01-getting-started/" >Getting started</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../01-getting-started/#quick-start-get-candella">Quick start: Get Candella</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../01-getting-started/#build-from-source">Build from source</a>
            </li>
            
            
        </ul>
        
        
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../02-celeste-shell/" >Celeste Shell</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../02-celeste-shell/#using-celeste-shell">Using Celeste Shell</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../02-celeste-shell/#available-methods-for-developers">Available methods for developers</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../03-candella-app/" >Writing a Candella app</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#creating-an-app">Creating an app</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#app-lifecycle">App lifecycle</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#convenience-methods">Convenience methods</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#app-storage">App storage</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#user-interfaces">User interfaces</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#sending-notifications">Sending notifications</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#sending-app-signals">Sending app signals</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../03-candella-app/#caapplication">CAApplication</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../04-observable/" >Observable Framework</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../04-observable/#what-uses-observable">What uses Observable?</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../04-observable/#logic">Logic</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../04-observable/#caobservable">CAObservable</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../05-multiuser/" >Multiuser Framework</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../05-multiuser/#what-is-a-candella-user">What is a Candella user?</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../05-multiuser/#the-userland-folder">The userland folder</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../05-multiuser/#readingwriting-data-for-the-current-user">Reading/writing data for the current user</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="./" aria-current="page" >Accounts Service</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="./#viewing-information-about-the-userspace">Viewing information about the userspace</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="./#managing-users">Managing users</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../07-roland-boot/" >Roland Boot Manager</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../07-roland-boot/#loading-the-boot-manager">Loading the boot manager</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../07-roland-boot/#shutting-down-candella-with-the-boot-manager">Shutting down Candella with the boot manager</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../08-thorax-setup/" >Thorax Setup</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../08-thorax-setup/#running-the-default-setup">Running the default setup</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../08-thorax-setup/#writing-a-custom-setup-script">Writing a custom setup script</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../09-glossary/" >Glossary</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../09-glossary/#creating-a-glossary">Creating a glossary</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../09-glossary/#displaying-the-glossary">Displaying the glossary</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../09-glossary/#overriding-the-default-glossary">Overriding the default glossary</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../10-candella-service/" >Writing core services</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../10-candella-service/#creating-a-core-service">Creating a core service</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../10-candella-service/#the-manifest-file">The manifest file</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../10-candella-service/#core-service-lifecycle">Core service lifecycle</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../10-candella-service/#sending-service-signals">Sending service signals</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../10-candella-service/#service-storage">Service storage</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../11-notifications/" >NotificationKit Changes</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../11-notifications/#notification-banner-design">Notification banner design</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../11-notifications/#creating-modular-banners">Creating modular banners</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../96-design-and-branding/" >Design and branding</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../96-design-and-branding/#design">Design</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../96-design-and-branding/#branding">Branding</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../97-deprecated/" >Deprecations</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../97-deprecated/#available">@available</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../97-deprecated/#deprecated">@deprecated</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../97-deprecated/#deprecated-arguments">deprecated arguments</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../98-stop-errors/" >Common Stop Errors</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../98-stop-errors/#requisite_framework_missing">REQUISITE_FRAMEWORK_MISSING</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../98-stop-errors/#missing_oobe_service">MISSING_OOBE_SERVICE</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../99-candella-sdk/" >Candella SDK</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../99-candella-sdk/#quickstart-install-from-pypi">Quickstart: Install from PyPI</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../99-candella-sdk/#build-the-sdk-from-source">Build the SDK from source</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../99-candella-sdk/#creating-projects">Creating projects</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../99-candella-sdk/#validating-projects">Validating projects</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../99-candella-sdk/#using-candella-sdk-programmatically">Using Candella SDK programmatically</a>
            </li>
            
            
        </ul>
        
        
        
        <ul class="p-side-navigation__list">
            <li class="p-side-navigation__item--title">
                <a class="p-side-navigation__link" href="../migrate/" >Migration from AliceOS</a>
            </li>
            
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../migrate/#full-announcement-from-project-alice">Full Announcement from Project Alice</a>
            </li>
            
            <li class="p-side-navigation__item">
                <a class="p-side-navigation__link" href="../migrate/#how-do-i-migrate">How do I migrate?</a>
            </li>
            
            
        </ul>
        
        
    </nav>
</div>


            <main id="main-content" class="col-9">
                <h1 id="accounts-service">Accounts Service</h1>
<p>The <strong>Accounts Service</strong> for Candella extends the functionality of the Multiuser framework and adds support for managing users in a way that lets other services handle this functionality. This service defines a single class, <code>CAAccountsService</code>, to manage users efficiently.</p>
<div class="admonition note">
<p class="admonition-title">Backwards Compatibility with AliceOS</p>
<p>To maintain backwards compatibility with AliceOS, the username of the currently logged-in user is set in AliceOS's <code>persistent.playername</code>. This field is commonly used by services and apps for the current player, and it also defines the player's name in games like <em>Doki Doki Literature Club!</em>.</p>
</div>
<h2 id="viewing-information-about-the-userspace">Viewing information about the userspace</h2>
<p>Currently, there are two static methods available to get information about the userspace:</p>
<ul>
<li><code>CAAccountsService.get_logged_in_user()</code> returns a <code>CAUser</code> object that contains the information about the currently logged-in user.</li>
<li><code>CAAccountsService.get_all_users()</code> returns a list of <code>CAUser</code> objects that contain information about all users known to Candella in the userspace.</li>
</ul>
<h2 id="managing-users">Managing users</h2>
<p>While accessing user information is static and does not require instancing, <code>CAAccountsService</code> should be instanced in the service or app that requests these features to manage data more efficiently. Including an instance in your service or app ensures that no other services are using that app's copy, and it helps reduce variables in Ren'Py's store.</p>
<div class="admonition warning">
<p class="admonition-title">Declare user permissions</p>
<p>For an app or service to manage users, the <code>manage_users</code> permission must be enabled for that service or app. This can be defined in the <code>permissions</code> field in an app's manifest and the <code>requisites</code> field in a service's manifest, respectively.</p>
</div>
<p>To instantiate an instance of the account manager, you'll need to pass in the service or app instance with the <code>manage_users</code> permission:</p>
<pre><code class="language-py">class SampleCoreService(CACoreService):
    def __init__(self):
        CACoreService.__init__(self)
        self._accounts = CAAccountsService(self)
</code></pre>
<h3 id="add_userself-username-pretty_namenone"><code>add_user(self, username, pretty_name=None)</code></h3>
<p>Creates the user file for a given user and adds it to the user list.</p>
<p><strong>Arguments</strong></p>
<ul>
<li>username (str): The username for the new user.</li>
<li>pretty_name (str): The display name for the new user.</li>
</ul>
<h3 id="change_current_userself-username"><code>change_current_user(self, username)</code></h3>
<p>Change the currently logged-in user.</p>
<p><strong>Arguments</strong></p>
<ul>
<li>username (str): The username of the user to switch to.</li>
</ul>
<h3 id="remove_userself-username"><code>remove_user(self, username)</code></h3>
<p>Removes the specified user.</p>
<p><strong>Arguments</strong></p>
<ul>
<li>username (str): The username of the user to remove.</li>
</ul>
            </main>
        </div>
    </div>
    <script>var base_url = '..';</script>

</body>

<footer>
    <div class="p-strip p-strip--light is-shallow">
        <div class="row">
            <p>Copyright &copy; 2021-2022 Unscripted VN Team.</p>
            <p class="p-link--external"><a href="https://github.com/UnscriptedVN/candella">View the source</a></p>
        </div>
    </div>
</footer>

</html>